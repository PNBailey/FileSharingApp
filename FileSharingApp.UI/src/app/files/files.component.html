<!-- <div class="d-flex justify-content-between align-items-center">
    <app-file-search></app-file-search>
    <button mat-flat-button (click)=" openFileUploadDialog()" class="me-3" color="primary">
        <mat-icon fontIcon="add"></mat-icon>
        Add Files
    </button>
</div>
<mat-divider></mat-divider> -->
<!-- <div class="container px-4 pb-2 d-flex justify-content-start">
    <div class="row">
        <div *ngFor="let file of files$ | async" class="col my-4 app-file-list-item">
            <app-file [file]="file" (deleteFileEvent)="deleteFile($event)"
                (viewFileEvent)="openFileViewDialog($event)"></app-file>
        </div>
    </div>
</div> -->
<!-- <mat-spinner class="container my-5 d-flex justify-content-center" matSuffix [diameter]="40"
    *ngIf="loadingFiles$ | async; else fileTable"></mat-spinner>
<div *ngIf="(files$ | async).length < 1 && !(loadingFiles$ | async)"
    class="container my-5 d-flex justify-content-center">
    <div class="row">
        <p>No files found...</p>
    </div>
</div> -->
<!-- <ng-template #fileTable>
    <p-table [value]="files" [paginator]="files.length > 1" [rows]="5" [tableStyle]="{ 'min-width': '50rem' }"
        [rowsPerPageOptions]="[5, 10, 20]">
        <ng-template pTemplate="header">
            <tr>
                <th style="width:25%" pSortableColumn="File Type">
                    File Type <p-sortIcon field="File Type" />
                </th>
                <th style="width:25%" pSortableColumn="Name">
                    Name <p-sortIcon field="Name" />
                </th>
                <th style="width:25%" pSortableColumn="File Added">
                    File Added <p-sortIcon field="File Added" />
                </th>
                <th style="width:25%">Actions</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-file>
            <tr (mouseenter)="file.isHovered = true" (mouseleave)="file.isHovered = false"
                [ngClass]="{'row-hovered': file.isHovered}">
                <td>{{ file.fileTypeName }}</td>
                <td>{{ file.name }}</td>
                <td>{{ file.lastUpdated }}</td>
                <td>
                    <div class="icon-buttons">
                        <button mat-icon-button class="m-1" aria-label="View" (click)="viewFile()">
                            <mat-icon color="primary">visibility</mat-icon>
                        </button>
                        <button mat-icon-button class="m-1" aria-label="Download" (click)="downloadFile()">
                            <mat-icon color="accent">download</mat-icon>
                        </button>
                        <button mat-icon-button class="m-1" aria-label="Delete" (click)="deleteFile()">
                            <mat-icon color="warn">delete</mat-icon>
                        </button>
                    </div>
                </td>
            </tr>
        </ng-template>
    </p-table>
</ng-template> -->

<p-table #dt [value]="files$ | async" [(selection)]="selectedFiles" dataKey="id" [rowHover]="true" [rows]="10"
    [showCurrentPageReport]="true" [rowsPerPageOptions]="[10, 25, 50]" [loading]="loadingFiles$ | async"
    [paginator]="true" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} files" [filterDelay]="0"
    [globalFilterFields]="['file.fileTypeName', 'file.name']">
    <ng-template pTemplate="caption">
        <div class="flex justify-content-between">
            <p-button [outlined]="true" icon="pi pi-filter-slash" label="Clear" (onClick)="clear(dt)" />
            <p-iconField iconPosition="left">
                <p-inputIcon>
                    <i class="pi pi-search"></i>
                </p-inputIcon>
                <input pInputText type="text" [(ngModel)]="searchValue"
                    (input)="dt.filterGlobal($event.target.value, 'contains')" placeholder="Keyboard Search" />
            </p-iconField>
        </div>
    </ng-template>
    <ng-template pTemplate="header">
        <tr>
            <th style="width: 4rem">
                <p-tableHeaderCheckbox />
            </th>
            <th pSortableColumn="file.type" style="min-width: 14rem">
                <div class="flex justify-content-between align-items-center">
                    File Type
                    <p-sortIcon field="file.type" />
                    <p-columnFilter field="file.type" matchMode="in" display="menu" [showMatchModes]="false"
                        [showOperator]="false" [showAddButton]="false" class="ml-auto">
                        <ng-template pTemplate="header">
                            <div class="px-3 pt-3 pb-0">
                                <span class="font-bold">File Type Picker</span>
                            </div>
                        </ng-template>
                        <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                            <p-multiSelect [ngModel]="value" [options]="fileTypes$ | async" placeholder="Any"
                                (onChange)="filter($event.value)" optionLabel="name">
                                <ng-template let-fileType pTemplate="item">
                                    <div class="inline-block vertical-align-middle">
                                        <img [alt]="fileType.name" src="{{ fileType.fileIconUrl }}" width="24"
                                            class="vertical-align-middle" />
                                        <span class="ml-1 mt-1">{{ fileType.name }}</span>
                                    </div>
                                </ng-template>
                            </p-multiSelect>
                        </ng-template>
                    </p-columnFilter>
                </div>
            </th>
            <th pSortableColumn="file.name" style="min-width: 14rem">
                <div class="flex justify-content-between align-items-center">
                    File Name
                    <p-sortIcon field="file.name" />
                    <p-columnFilter type="text" field="file.name" display="menu" class="ml-auto" />
                </div>
            </th>
            <th pSortableColumn="file.added" style="min-width: 14rem">
                <div class="flex justify-content-between align-items-center">
                    File Added
                    <p-sortIcon field="file.added" />
                    <p-columnFilter type="text" field="file.added" display="menu" class="ml-auto" />
                </div>
            </th>
            <th style="width: 5rem"></th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-file>
        <tr class="p-selectable-row">
            <td>
                <p-tableCheckbox [value]="file" />
            </td>
            <td>
                <span class="p-column-title">File Type</span>
                <img src="https://primefaces.org/cdn/primeng/images/demo/flag/flag_placeholder.png" />
                <span class="ml-1 vertical-align-middle">{{ file.fileTypeName }}</span>
            </td>
            <td>
                <span class="p-column-title">File Name</span>
                {{ file.name }}
            </td>
            <td>
                <span class="p-column-title">File Added</span>
                {{ file.added }}
            </td>
        </tr>
    </ng-template>
    <ng-template pTemplate="emptymessage">
        <tr>
            <td colspan="8">No files found.</td>
        </tr>
    </ng-template>
</p-table>